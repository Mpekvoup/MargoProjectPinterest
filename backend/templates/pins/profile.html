{% extends 'base.html' %}

{% block title %}{{ profile_user.username }} - Pinterest Clone{% endblock %}

{% block content %}
<div class="container">
    <div class="profile-header">
        <div class="profile-avatar">
            <svg width="120" height="120" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
        </div>
        <h1>{{ profile_user.username }}</h1>
        <p class="profile-stats">
            <strong>{{ pins.count }}</strong> пинов • <strong>{{ boards.count }}</strong> досок
        </p>
    </div>

    <div class="profile-tabs">
        <button class="tab-btn active" data-tab="pins">Пины</button>
        <button class="tab-btn" data-tab="boards">Доски</button>
    </div>

    <div class="tab-content active" id="pins-tab">
        {% if pins %}
            <div class="masonry-grid">
                {% for pin in pins %}
                    <div class="pin-card">
                        <a href="{% url 'pin_detail' pin.pk %}" class="pin-image-link">
                            <img src="{{ pin.image.url }}" alt="{{ pin.title }}" class="pin-image" loading="lazy">
                        </a>
                        <div class="pin-info">
                            <h3 class="pin-title">
                                <a href="{% url 'pin_detail' pin.pk %}">{{ pin.title }}</a>
                            </h3>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <h2>Пинов пока нет</h2>
                {% if user == profile_user %}
                    <a href="{% url 'pin_create' %}" class="btn btn-primary">Создать первый пин</a>
                {% endif %}
            </div>
        {% endif %}
    </div>

    <div class="tab-content" id="boards-tab">
        {% if boards %}
            <div class="boards-grid">
                {% for board in boards %}
                    <div class="board-card">
                        <a href="{% url 'board_detail' board.slug %}" class="board-link">
                            <div class="board-cover">
                                {% if board.pins.first %}
                                    <img src="{{ board.pins.first.image.url }}" alt="{{ board.name }}">
                                {% else %}
                                    <div class="board-placeholder">
                                        <svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
                                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
                                        </svg>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="board-info">
                                <h3>{{ board.name }}</h3>
                                <p class="board-meta">{{ board.pins_count }} пинов</p>
                            </div>
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <h2>Досок пока нет</h2>
                {% if user == profile_user %}
                    <a href="{% url 'board_create' %}" class="btn btn-primary">Создать доску</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Tab switching
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const tabName = this.dataset.tab;

        // Update buttons
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');

        // Update content
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.getElementById(tabName + '-tab').classList.add('active');

        // Reinit masonry
        setTimeout(() => initMasonryGrid(), 100);
    });
});

document.addEventListener('DOMContentLoaded', function() {
    initMasonryGrid();
});
</script>
{% endblock %}
